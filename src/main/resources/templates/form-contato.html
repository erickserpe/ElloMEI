<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: layout-base(~{::title}, ~{::div})}">
<head>
    <meta charset="UTF-8">
    <title>Formulário de Contato</title>
</head>
<body>

<div class="p-4">
    <!-- Page Header -->
    <div class="mb-4">
        <h1 class="h2 fw-bold text-gray-900 mb-1">Cadastro de Contato</h1>
        <p class="text-muted mb-0">Adicione ou edite informações do contato</p>
    </div>

    <!-- Form Card -->
    <div class="form-section-card">
        <div class="form-section-header">
            <h5>
                <i class="bi bi-person text-primary"></i>
                Informações do Contato
            </h5>
        </div>
        <div class="form-section-body">
            <form th:action="@{/contatoes}" method="post" th:object="${contato}">
                <input type="hidden" th:field="*{id}" />

                <div class="row g-4">
                    <div class="col-md-6">
                        <label for="tipoContato" class="form-label">
                            <i class="bi bi-tag me-1"></i>
                            Tipo de Contato *
                        </label>
                        <select class="form-select" id="tipoContato" th:field="*{tipoContato}" required>
                            <option value="">Selecione o tipo</option>
                            <option th:each="tipoOpt : ${T(br.com.scfmei.domain.TipoContato).values()}"
                                    th:value="${tipoOpt}" th:text="${tipoOpt.descricao}"></option>
                        </select>
                    </div>

                    <div class="col-12">
                        <div id="pessoa-fisica-fields">
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <label for="nomeCompleto" class="form-label">
                                        <i class="bi bi-person me-1"></i>
                                        Nome Completo
                                    </label>
                                    <input type="text" class="form-control" id="nomeCompleto" th:field="*{nomeCompleto}"
                                           placeholder="Ex: João da Silva">
                                </div>
                                <div class="col-md-6">
                                    <label for="cpf" class="form-label">
                                        <i class="bi bi-card-text me-1"></i>
                                        CPF
                                    </label>
                                    <input type="text" class="form-control" id="cpf" th:field="*{cpf}"
                                           placeholder="000.000.000-00">
                                    <div class="invalid-feedback d-block" th:if="${#fields.hasErrors('cpf')}" th:errors="*{cpf}"></div>
                                </div>
                            </div>
                        </div>

                        <div id="pessoa-juridica-fields" style="display: none;">
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <label for="razaoSocial" class="form-label">
                                        <i class="bi bi-building me-1"></i>
                                        Razão Social
                                    </label>
                                    <input type="text" class="form-control" id="razaoSocial" th:field="*{razaoSocial}"
                                           placeholder="Nome legal da empresa">
                                </div>
                                <div class="col-md-6">
                                    <label for="nomeFantasia" class="form-label">
                                        <i class="bi bi-shop me-1"></i>
                                        Nome Fantasia
                                    </label>
                                    <input type="text" class="form-control" id="nomeFantasia" th:field="*{nomeFantasia}"
                                           placeholder="Nome comercial">
                                </div>
                                <div class="col-md-6">
                                    <label for="cnpj" class="form-label">
                                        <i class="bi bi-building-check me-1"></i>
                                        CNPJ
                                    </label>
                                    <input type="text" class="form-control" id="cnpj" th:field="*{cnpj}"
                                           placeholder="00.000.000/0000-00">
                                    <div class="invalid-feedback d-block" th:if="${#fields.hasErrors('cnpj')}" th:errors="*{cnpj}"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="mt-4 d-flex justify-content-end gap-3">
                    <a th:href="@{/contatoes}" class="btn btn-outline-secondary">
                        <i class="bi bi-x-circle me-2"></i>
                        Cancelar
                    </a>
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-check-circle me-2"></i>
                        Salvar Contato
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tipoContatoSelect = document.getElementById('tipoContato');
            const pfFields = document.getElementById('pessoa-fisica-fields');
            const pjFields = document.getElementById('pessoa-juridica-fields');

            function toggleFields() {
                const selectedValue = tipoContatoSelect.value;
                if (selectedValue === 'PESSOA_FISICA') {
                    pfFields.style.display = 'block';
                    pjFields.style.display = 'none';
                } else if (selectedValue === 'PESSOA_JURIDICA') {
                    pfFields.style.display = 'none';
                    pjFields.style.display = 'block';
                } else {
                    pfFields.style.display = 'block'; // Padrão
                    pjFields.style.display = 'none';
                }
            }

            // Garante que o estado correto seja exibido ao carregar a página (para edição)
            toggleFields();

            // Adiciona o listener para mudanças
            tipoContatoSelect.addEventListener('change', toggleFields);
        });
    </script>
</div>

</body>
</html>