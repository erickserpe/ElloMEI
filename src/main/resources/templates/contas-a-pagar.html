<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: layout-base(~{::title}, ~{::#contas-a-pagar-content})}">
<head>
    <title>Contas a Pagar</title>
</head>
<body>
<div id="contas-a-pagar-content" class="p-4">
    <!-- Page Header -->
    <div class="mb-4">
        <h1 class="h2 fw-bold text-gray-900 mb-1">Contas a Pagar</h1>
        <p class="text-muted mb-0">Gerencie suas obrigações financeiras pendentes</p>
    </div>

    <!-- Accounts Payable Table Card -->
    <div class="content-card">
        <div class="content-card-header">
            <h5>
                <i class="bi bi-calendar-week text-primary me-2"></i>
                Lista de Contas a Pagar
            </h5>
        </div>
        <div class="content-card-body p-0">
            <div class="table-responsive">
                <table class="table table-modern mb-0">
                    <thead>
                    <tr>
                        <th>Vencimento</th>
                        <th>Descrição</th>
                        <th>Valor</th>
                        <th>Comprovantes</th>
                        <th style="width: 220px;">Ações</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:if="${#lists.isEmpty(contasAPagar)}">
                        <td colspan="5" class="text-center py-5">
                            <div class="py-3">
                                <i class="bi bi-calendar-check display-4 text-muted mb-3"></i>
                                <h6 class="text-muted">Nenhuma conta a pagar no momento</h6>
                                <p class="text-muted small">Suas obrigações aparecerão aqui</p>
                            </div>
                        </td>
                    </tr>
                    <tr th:each="conta : ${contasAPagar}">
                        <td th:text="${#temporals.format(conta.data, 'dd/MM/yyyy')}"></td>
                        <td th:text="${conta.descricao}"></td>
                        <td th:text="${'R$ ' + #numbers.formatDecimal(conta.valor, 1, 'POINT', 2, 'COMMA')}"></td>
                        <td>
                            <div th:if="${!#lists.isEmpty(conta.comprovantes)}">
                                <div th:each="comp : ${conta.comprovantes}">
                                    <a th:href="@{/uploads/{filename}(filename=${comp.pathArquivo})}"
                                       th:text="${#strings.substringAfter(comp.pathArquivo, '_')}"
                                       target="_blank" class="d-block text-primary">
                                        <i class="bi bi-file-earmark-text me-1"></i> Ver Anexo
                                    </a>
                                </div>
                            </div>
                            <span th:if="${#lists.isEmpty(conta.comprovantes)}" class="text-muted">Nenhum</span>
                </td>
                        <td>
                            <div class="btn-group-actions">
                                <a th:href="@{/lancamentos/editar/{id}(id=${conta.id})}" class="btn-action btn-action-view" title="Visualizar">
                                    <i class="bi bi-eye"></i>
                                </a>
                                <form th:action="@{/contas-a-pagar/pagar/{id}(id=${conta.id})}" method="post" class="d-inline">
                                    <button type="submit" class="btn-action" style="color: var(--success-600); border-color: rgba(16, 185, 129, 0.2); background: rgba(16, 185, 129, 0.05);" title="Marcar como Pago">
                                        <i class="bi bi-check-lg"></i>
                                    </button>
                                </form>
                            </div>
                        </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>